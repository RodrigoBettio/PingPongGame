<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo Ping-Pong</title>
</head>

<body>
    <canvas></canvas>
    <style>
        * {
            padding: 0;
            margin: 0;
            overflow: hidden;
        }
    </style>
    <script>
        const canvasEl = document.querySelector("canvas"), //Seletor do canvas
            canvasCtx = canvasEl.getContext("2d") //Item 2d ou 3d?

        const gapX = 10

        const espaco = {
            w: window.innerWidth,
            h: window.innerHeight,
            estrelas: [], // Array para armazenar as estrelas

            criarEstrelas: function () {
                // Gerar as estrelas apenas uma vez
                for (let i = 0; i < 100; i++) {
                    const x = Math.random() * this.w;
                    const y = Math.random() * this.h;
                    const size = Math.random() * 1.5;
                    this.estrelas.push({ x, y, size });
                }
            },

            desenhar: function () {
                // Gradiente de fundo
                const gradiente = canvasCtx.createLinearGradient(0, 0, this.w, this.h);
                gradiente.addColorStop(0, "#000428"); // Azul escuro
                gradiente.addColorStop(1, "#004e92"); // Azul claro

                canvasCtx.fillStyle = gradiente;
                canvasCtx.fillRect(0, 0, this.w, this.h);

                // Desenhar as estrelas armazenadas
                canvasCtx.fillStyle = "white";
                for (let i = 0; i < this.estrelas.length; i++) {
                    const estrela = this.estrelas[i];
                    canvasCtx.beginPath();
                    canvasCtx.arc(estrela.x, estrela.y, estrela.size, 0, Math.PI * 2);
                    canvasCtx.fill();
                }
            }
        }

        const linha = {
            w: 12,
            h: espaco.h,
            desenhar: function () {
                canvasCtx.fillStyle = "#fff"

                const x = espaco.w / 2 - this.w / 2
                const y = 0
                const w = this.w
                const h = this.h

                canvasCtx.fillRect(x, y, w, h)
            }
        }

        const naveEsquerda = {
            x: gapX,
            y: 300,
            w: 15,
            h: 200,
            desenhar: function () {
                canvasCtx.fillRect(this.x, this.y, this.w, this.h) //Eixo x,  eixo y, espessura, altura
            }
        }

        const naveDireita = {
            x: espaco.w - 15 - gapX,
            y: 400,
            w: 15,
            h: 200,

            desenhar: function () {
                canvasCtx.fillRect(this.x, this.y, this.w, this.h)
            }
        }

        const bola = {
            x: 200,
            y: 300,
            r: 20,
            speedX: 3, // Velocidade horizontal
            speedY: 3, // Velocidade vertical

            _mover: function () {
                this.x += this.speedX;
                this.y += this.speedY;

                // Rebote nas laterais (superior e inferior)
                if (this.y - this.r < 0 || this.y + this.r > espaco.h) {
                    this.speedY *= -1; // Inverte a direção vertical
                    this.speedX *= 1.08;
                    this.speedY *= 1.08;
                }

                // Rebote na nave esquerda
                if (
                    this.x - this.r < naveEsquerda.x + naveEsquerda.w &&
                    this.y > naveEsquerda.y &&
                    this.y < naveEsquerda.y + naveEsquerda.h
                ) {
                    this.speedX *= -1; // Inverte a direção horizontal
                    this.x = naveEsquerda.x + naveEsquerda.w + this.r; // Evita sobreposição
                }

                // Rebote na nave direita
                if (
                    this.x + this.r > naveDireita.x &&
                    this.y > naveDireita.y &&
                    this.y < naveDireita.y + naveDireita.h
                ) {
                    this.speedX *= -1; // Inverte a direção horizontal
                    this.x = naveDireita.x - this.r; // Evita sobreposição
                }
            },

            desenhar: function () {
                canvasCtx.fillStyle = "#fff";
                canvasCtx.beginPath();
                canvasCtx.arc(this.x, this.y, this.r, 0, Math.PI * 2);
                canvasCtx.fill();

                this._mover(); // Convenção colocar underline para funções internas
            }
        }

        const placar = {
            humano: 1,
            humano2: 2,

            desenhar: function () {
                canvasCtx.font = "bold 72px Arial"
                canvasCtx.textAlign = "center"
                canvasCtx.textBaseline = "top"
                canvasCtx.fillStyle = "#fff"

                canvasCtx.fillText(this.humano, espaco.w / 4, 50)
                canvasCtx.fillText(this.humano2, espaco.w / 4 + espaco.w / 2, 50) //1/4 do campo + metade para ir pro outro lado
            }

        }

        const teclas = {
            "ArrowUp": false,
            "ArrowDown": false,
            "w": false,
            "s": false,
        }

        document.addEventListener("keydown", function (event) {
            teclas[event.key] = true; // Marca a tecla como pressionada
        });

        document.addEventListener("keyup", function (event) {
            teclas[event.key] = false; // Marca a tecla como solta
        });

        function setup() {
            canvasEl.width = window.innerWidth  //Captura largura e altura da tela
            canvasCtx.width = window.innerWidth

            canvasEl.height = window.innerHeight
            canvasCtx.height = window.innerHeight

            espaco.criarEstrelas(); //Cria as estrelas apenas uma vez por partida
        }

        function desenhar() {
            //Plano de Fundo
            espaco.desenhar()

            //Linha do jogo
            linha.desenhar()
            // Movimento das naves
            if (teclas["w"] && naveEsquerda.y > 0) {
                naveEsquerda.y -= 5;
            } else if (teclas["s"] && naveEsquerda.y + naveEsquerda.h < espaco.h) {
                naveEsquerda.y += 5;
            }

            if (teclas["ArrowUp"] && naveDireita.y > 0) {
                naveDireita.y -= 5;
            } else if (teclas["ArrowDown"] && naveDireita.y + naveDireita.h < espaco.h) {
                naveDireita.y += 5;
            }

            //Criação das "naves"
            //Nave esquerda
            naveEsquerda.desenhar()

            //Nave direita
            naveDireita.desenhar()

            //Criando a Bola
            bola.desenhar()

            //Placar do jogo
            placar.desenhar()

        }

        window.animateFrame = (function () {
            return (
                window.requestAnimationFrame ||
                window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame ||
                window.oRequestAnimationFrame ||
                window.msRequestAnimationFrame ||
                function (callback) {
                    return window.setTimeout(callback, 1000 / 60)
                }
            )
        })()

        function main() {
            animateFrame(main)
            desenhar()
        }

        setup()
        main()
    </script>

</body>

</html>